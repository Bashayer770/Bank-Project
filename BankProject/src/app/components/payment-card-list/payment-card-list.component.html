<div class="flex flex-col items-end p-4 w-full">
  <!-- Card Stack -->
  <div class="relative w-[360px] h-[250px]">
    <ng-container *ngFor="let card of cards(); let i = index">
      <div
        class="absolute top-0 transition-all duration-500 ease-in-out cursor-pointer"
        [ngStyle]="{
          transform:
            selectedIndex() === i
              ? 'translateX(0) scale(1)'
              : 'translateX(' + i * 20 + 'px) scale(0.95)',
          zIndex: selectedIndex() === i ? 50 : i
        }"
        (click)="selectCard(i)"
      >
        <app-payment-card [card]="card" [flipped]="false"></app-payment-card>
      </div>
    </ng-container>
  </div>

  <button
    class="mt-4 px-6 py-2 bg-green-600 text-white font-semibold rounded-xl shadow-lg hover:bg-green-700 transition-all"
    (click)="openModal()"
  >
    + Add Card
  </button>
</div>

<app-add-card-modal
  *ngIf="showModal()"
  (save)="addCard($event)"
  (submit)="addManualCard($event)"
  (closeModal)="hideModal()"
></app-add-card-modal>
